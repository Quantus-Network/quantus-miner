# NVIDIA RTX 3060 (SM 86) — CUDA G2 auto-tuned debug configuration
# This profile enables the G2 kernel with auto-tuned per-batch iterations.
# Do NOT set MINER_CUDA_DESIRED_ITERS; the host will auto-tune to cover the
# active window per batch. Sampler and host-side verify are enabled.

# Engine selection (the service passes --engine gpu-cuda; this is informational)
# MINER_ENGINE=gpu-cuda

# Kernel mode and image
MINER_CUDA_MODE=g2
MINER_CUDA_IMAGE=ptx

# Launch geometry
# - THREADS: max threads available to the launcher (active threads per batch are computed dynamically)
# - BLOCK_DIM: CUDA block size; 256 is a good default on Ampere
MINER_CUDA_THREADS=4096
MINER_CUDA_BLOCK_DIM=256

# Per-thread iteration budget (upper bound used by autotuner)
# The autotuner will pick desired_iters <= MINER_CUDA_ITERS to cover the current window.
MINER_CUDA_ITERS=8192

# Number of batches per window. With autotune, a small number (e.g., 4) reduces launch overhead.
MINER_CUDA_BATCHES=4

# Enable device sampler (captures y/H/target/threshold for the first (tid=0,j=0) item)
MINER_CUDA_SAMPLER=1

# Host-side verification: sample the first N attempted nonces each window to detect missed winners
# if logs contain “host-only winner missed” or sampler mismatches, temporarily raise MINER_CUDA_VERIFY back to the window size (≈ attempts_used) to capture detailed evidence.
#MINER_CUDA_VERIFY=200000
MINER_CUDA_VERIFY=2048

# Optional: force a device-side early-exit at (tid=0,j=0) to validate GPU->CPU signaling.
# Leave commented/disabled for normal operation.
# MINER_CUDA_FORCE_WIN=1

# Logging
RUST_LOG=miner=debug
