# NVIDIA RTX 5090 (SM 120) â€” CUDA G2 auto-tuned upper profile (dedicated mining system)
# This profile enables the G2 kernel with auto-tuned per-batch iterations.
# Do NOT set MINER_CUDA_DESIRED_ITERS; the host will auto-tune to cover the window per batch.
# Sampler and host-side verify are disabled to minimize overhead on a dedicated rig.

# Kernel mode and image
MINER_CUDA_MODE=g2
MINER_CUDA_IMAGE=ptx

# Launch geometry
# - THREADS: maximum threads the launcher may use (active threads are tuned per batch)
# - BLOCK_DIM: CUDA block size; 256 is a solid default on Blackwell (5090)
MINER_CUDA_THREADS=65536
MINER_CUDA_BLOCK_DIM=256

# Per-thread iteration budget (upper bound used by the autotuner)
# The autotuner will pick desired_iters <= MINER_CUDA_ITERS to cover the current window.
MINER_CUDA_ITERS=32768

# Single batch per window to minimize launch overhead on dedicated systems
MINER_CUDA_BATCHES=1

# Disable device sampler and host-side verify for minimal overhead
MINER_CUDA_SAMPLER=0
MINER_CUDA_VERIFY=0

# Optional: force a device-side early-exit at (tid=0,j=0) to validate GPU->CPU signaling.
# Leave commented/disabled for normal operation.
# MINER_CUDA_FORCE_WIN=1

# Tight logging for production-like runs on dedicated systems
RUST_LOG=miner=info
